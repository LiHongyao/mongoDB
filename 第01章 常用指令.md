# 一、数据库操作

```markdown
# 1. 查看数据库
show dbs
# 2. 创建/切换数据库
use <db_name>
# 3. 查看当前数据库
db
# 4. 删除数据库
db.dropDatabase()
```

> 注意：刚创建的数据库需要插入数据才能够显示。

# 二、集合操作

```markdown
# 1. 查看集合帮助
db.<数据库名>.help()
# 2. 查看集合
show collections
# 3. 创建集合
db.createCollection(collection_Name)
# 4. 创建集合并插入一个文档
db.collection_Name.insert(document)
```

# 三、文档操作

## 1. 插入文档

- `db.collection_name.insert(document)`：插入文档/存在_id则失败，否则插入
- `db.collection_name.save(document)`：插入文档/存在_id则更新，否则插入

## 2. 更新文档

语法解读：

```js
db.collection.update(
   <query>,
   <updateObj>,
   {
     upsert: <boolean>,
     multi: <boolean>
   }
)
```

语法解读：

- `query` ：查询条件

- `update`：更新后的对象或指定一些更新的操作符

- `upsert`：可选，未查询到时是否插入updateObj，默认false。

- `multi`：可选，是否更新所有查询到的文档，默认false。

### # 操作符

**\1. $inc**

```js
{ $inc: { <field1>: <amount1>, <field2>: <amount2>, ... } }
```

> 解读：在原基础上累加（increment）

```js
> db.stus.update({name:"木子李"}, {$inc:{age: 10}})
```

给 {name:"木子李"} 文档的age累加10。

**\2. $push**

```js
{ $push: { <field1>: <value1>, ... } }
```

> 解读：向数组中添加元素，不会覆盖已有的

```js
db.stus.update({name: "木子李"}, {$push: {hobby: "吉他"}})
```

**\3. $addToSet**

```js
{ $addToSet: { <field1>: <value1>, ... } }
```

> 解读：给数组添加或者设置一个值，

## 3. 删除文档

语法形式：

```js
db.collection.remove(
   <query>,
   {
     justOne: <boolean>
   }
)
```

参数解读：

- query :（可选）查询条件。
- justOne : （可选）是否只删除匹配结果中的第1个

示例代码：

```js
db.stus.remove({name: "木子李"});
```

## 4. 查询文档

### 4.1. find()

语法形式：

```js
db.collection_name.find(query, projection)；
```

参数解读：

- query：使用查询操作符指定选择过滤器 
- projection：定配到到的文档中的返回的字段。

```js
db.stus.find({}, {_id: false, name: true, age: true});
```

查询文档中的 `name`、`age ` 字段，排除 `_id` 字段。

### 4.2. findOne()

查询匹配结构中的第一个

### 4.3. 查询操作符

- `$in`：数组中包含
- `$nin`：数组中不包含
- `$not`：排除
- `$gt`：大于
- `$gte`：大于等于
- `$lt`：小于
- `$lte`：小于等于
- `$ne`：不等于

代码示例：

```markdown
# 1. 查询年龄为20、30岁的数据
db.stus.find({age: {$in: [20, 30]}});
# 2. 查询年龄不为20、30岁的数据
db.stus.find({age: {$nin: [20, 30]}});
# 3. 查询年龄大于18岁的数据
db.stus.find({age: {$gt: 18}});
# 4. 查询年龄小于18岁的数据
db.stus.find({age: {$lt: 18}});
# 5. 查询姓名不等于‘木子李’的数据
db.stus.find({name: {$ne: "木子李"}})
# 6. 正则表达式查询
```

### 4.4. 正则表达式

语法形式：

```js
db.collectoin_name.find({key: /val/})
```

### 4.5. 联合查询

```markdown
# 1. and 查询
db.collection_name.find({ field1: value1, field2: value2 })
# 2. or 查询
db.collection_name.find({ $or: [{key1: value1}, {key2:value2} ] })
```

### 4.6. 分页查询

```markdown
# 1. 查询指定数量的数据
db.collectoin_name.find().limit(number)
# 2. 跳过指定数量的数据
db.collectoin_name.find().skip(number)
# 3. 排序：1为升序，-1为降序
db.collectoin_name.find().sort({field:1/-1})
# 4. 分页查询
> let pageIndex = 3;
> let pageSize = 3;
> db.grade1.find().skip((pageIndex - 1) * pageSize).limit(pageSize).sort({username: 1});
```







